<div class="default" ng-app="WtDirectory" id="app">
  	<div class="fade grid-x grid-margin-x padding">
    	<div class="centered cell">
      		<h2>Search</h2> 

      		<ul class="tabs" data-tabs id="example-tabs">
			  	<li class="tabs-title is-active"><a href="#panel1" aria-selected="true">Google</a></li>
			  	<li class="tabs-title"><a data-tabs-target="panel2" href="#panel2">Directory</a></li>
			  	<li class="tabs-title"><a data-tabs-target="panel3" href="#panel3">Experts</a></li>
			</ul>

	      	<div class="tabs-content" data-tabs-content="example-tabs">
	  			<div class="tabs-panel is-active" id="panel1">
	    			<form action="./" id="searchWeb" method="get">
                        <div class="search-field">
                            <div class="input-group">
                                <input aria-labelledby="search-label" id="search_text_box" name="q" placeholder="Search WT" role="textbox" type="search">
                                <div class="input-group-button">
                                    <input type="submit" class="button primary" value="Submit">
                                </div>
                            </div>
                        </div>
                        <div class="gcse-searchresults-only" data-linktarget="_parent">&#160;</div>
                    </form>                    
	  			</div>
	  			
		  		<div class="tabs-panel" id="panel2" ng-controller="directorySearch">
		  		    
		  		    <div>
	    		        <input type="radio" ng-model="type" value="staff"/> Faculty Staff
                        <input type="radio" ng-model="type" value="student" /> Students
		    		</div>
		    		    
		    		<form ng-submit="submit()">		  
	    		        <div class="input-group">
                            <input type="text" ng-model="search" placeholder="Search">
                            <div class="input-group-button">
                                <input type="submit" class="button primary" value="Submit">
                            </div>
                        </div>
	    		    </form>	   		
		    		
		    		
                    <div class="grid-x medium-up-2 large-up-3 grid-margin-x grid-margin-y">                                        
    					<div class="animation cell grid-x" ng-repeat="person in people" style="padding-left: 0">
    						<div class="small-8 cell">
                                <h3>{[{person.fname}]} {[{person.lname}]}</h3>
        						<div class="caption small-12 medium-12 large-6" style="float: left">
        							<div ng-hide="!person.title"><strong>Title:</strong> {[{person.title}]}</div>
        							<div ng-hide="!person.building"><strong>Location:</strong> {[{person.building}]} {[{person.room}]}</div>
        							<p class="hide">{[{person.expertise}]}</p>
        							<div ng-hide="!person.phone"><a href="tel:{{person.phone}}">{[{person.phone}]}</a></div>
        							<div ng-hide="!person.email"><a href="mailto:{{person.email}}">{[{person.email}]}</a></div>
        				        </div>
                            </div>
                            
        					<div class="small-4 cell">
        						<div class="small-8 small-centered">
        							<img src="http://apps.wtamu.edu{[{person.imgUrl}]}" />
        						</div>
        					</div>
                        </div>
                    </div>			    		
		  		</div>		  		
		  
		  		<div class="tabs-panel" id="panel3" ng-controller="expertSearch">
		    		<select name="repeatSelect" id="repeatSelect" ng-model="search.expertgroup.expertise">
                        <option value="" selected>Select Expertise</option>
                        <option ng-repeat="option in data.availableOptions" value="{[{option.name}]}">{[{option.name}]}</option>
                    </select>        
                    
                    <div class="grid-x medium-up-2 large-up-3 grid-margin-x grid-margin-y">      

    					<div class="animation cell grid-x" ng-repeat="person in people | filter:search track by $index " style="padding-left: 0">
    						<div class="small-8 cell">
                                <h3>{[{person.fname}]} {[{person.lname}]}, {[{person.designation}]} </h3>
        						<div class="caption small-12 medium-12 large-6" style="float: left">
        						    <div><strong>Title:</strong><span ng-repeat="position in person.posgroup"> {[{position.title}]}<br /></span></div>
        							<div><strong>Location:</strong> {[{person.building}]} {[{person.room}]}</div>
        							<p class="hide">{[{person.expertise}]}</p>
        							<a href="tel:{{person.phone}}">{[{person.phone}]}</a><br />
        							<a href="mailto:{{person.email}}">{[{person.email}]}</a>
        				        </div>
                            </div>              
                    
                            <div class="small-4 cell">
                                <div class="small-8 small-centered">
                                	<img src="http://cascadetest.wtamu.edu/test/directory/{[{person.image}]}" />
                                </div>
                            </div>
                            <div class="text-right" ng-hide="true">
                                <a href="#" class="button small-12 large-6">View Biography</a>
                            </div>
                        </div>

                    </div>                     
		  		</div>		  	
		  	</div>
    	</div>
  	</div>
  	
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.6/angular-animate.js"></script>
<script src="{{root}}assets/x2js-master/xml2json.min.js"></script>
<script type="text/javascript">
	// <![CDATA[                                                        
	var imgAltTagsFix = function() {
		var gscSearch = document.querySelector('input.gsc-search-button');
		//var gscBranding = document.querySelector('.gcsc-branding');
		gscSearch.setAttribute('alt', 'Google Custom Search Button');
		//gscBranding.setAttribute('aria-hidden', 'True');
	};
	window.__gcse = {
		callback: imgAltTagsFix
	};
	(function() {
		var cx = '017207163629162198634:3oziw4igxw8';
		var gcse = document.createElement('script');
		gcse.type = 'text/javascript';
		gcse.async = true;
		gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
			'//www.google.com/cse/cse.js?cx=' + cx;
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(gcse, s);
	})();
	// ]]>

    $(document).ready(function () { 
        var q = wf.getParameterByName('q');
        $('#search_text_box').val(q);       
    });

</script> 

<script>               

    var App = angular.module('WtDirectory', ['ngAnimate']).config(function($interpolateProvider){
        $interpolateProvider.startSymbol('{[{').endSymbol('}]}');
    });

    App.controller('expertSearch', function($scope, $http) {
        $http.get('{{root}}assets/experts.js')
        .then(function(res) {
        $scope.people = res.data;
         
        $scope.data = {
            model: null,
            availableOptions: [
                { name: 'Accounting'},
                { name: 'Advertising and PR' },
                { name: 'Agriculture' },
                { name: 'Agricultural Business and Economics' },
                { name: 'AIDS and HIV' },
                { name: 'Alternative Energy' },
                { name: 'Animal Science' },
                { name: 'Art' },
                { name: 'Banking' },
                { name: 'Biology' },
                { name: 'Business Communication' },
                { name: 'Campus/Student Life' },
                { name: 'Chemistry' },
                { name: 'Child Development and Early Education' },
                { name: 'Codicology' },
                { name: 'Communication Disorders' },
                { name: 'Communication Studies' },
                { name: 'Criminal Justice' },
                { name: 'Curriculum Development' },
                { name: 'Dance' },
                { name: 'Disaster Planning' },
                { name: 'Distance Education and Instructional Technology' },
                { name: 'Diversity Issues/Multiculturalism' },
                { name: 'Economics' },
                { name: 'Education' },
                { name: 'Energy Resources' },
                { name: 'Engineering and Engineering Technology' },
                { name: 'English Language' },
                { name: 'Environmental Science' },
                { name: 'Finance' },
                { name: 'Foreign Language/Cultures' },
                { name: 'Geography' },
                { name: 'Geology' },
                { name: 'Health, Nursing and Medical Issues' },
                { name: 'Higher Education' },
                { name: 'History' },
                { name: 'Information Technology' },
                { name: 'International Business and Trade' },
                { name: 'Law and Legal Issues' },
                { name: 'Leadership' },
                { name: 'Learning Styles/Teaching Methods' },
                { name: 'Literacy and Reading' },
                { name: 'Literature' },
                { name: 'Management' },
                { name: 'Marketing' },
                { name: 'Marriage and Family' },
                { name: 'Mass Communication/Media' },
                { name: 'Mathematics' },
                { name: 'Music' },
                { name: 'Organizational Behavior' },
                { name: 'Physical Education, Recreation and Leisure' },
                { name: 'Plant Science' },
                { name: 'Politics and Government' },
                { name: 'Pop Culture' },
                { name: 'Psychology' },
                { name: 'Religion' },
                { name: 'Science Education' },
                { name: 'Sociology/Social Work' },
                { name: 'Soil Science/Management' },
                { name: 'Spanish Language' },
                { name: 'Statistics' },
                { name: 'Strategic Planning' },
                { name: 'Terrorism' },
                { name: 'Theatre' },
                { name: 'Transportation' },
                { name: 'Writing' }
            ]
        };
        (window.angular);
        
        });
    });

    App.controller('directorySearch', function($scope, $http) {

        $scope.people = [];
        $scope.list = [];
        $scope.text = 'hello';
        $scope.type = 'staff';

        $scope.submit = function() {
            
            if($scope.type == "staff") {                  
                var data = $.param({
                    search: $scope.search,
                    stype: 'fs',
                    xml_output: 1
                });
            }
                
            if($scope.type == "student") {                  
                var data = $.param({
                    search: $scope.search,
                    stype: 'stu',
                    xml_output: 1
                });                
            }
            
            var config = {
                headers : {
                    'Content-Type': 'application/x-www-form-urlencoded'
                }
            };
            
            $http.post('//apps.wtamu.edu/dir/', data, config)
            .success(function(data, headers, config){
                var x2js = new X2JS();
                var json = x2js.xml_str2json( data );
                $scope.people = json.directory.results.result;
                //console.log($scope.people);
            });
        };                
    });
            
</script>